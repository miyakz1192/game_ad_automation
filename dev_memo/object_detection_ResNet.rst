================================================
pytorch で ResNetを試す
================================================

インストール
=================

すでにpytorchが入っている環境に:: 
  sudo pip  install jupyterlab
  pip install pandas
  pip install -U scikit-learn
  

試してみる
============

ブランチは以下::

  origin  https://github.com/miyakz1192/resset.git (fetch)

見てみると、素早く収束するようだが、データ数が多すぎて学習時間があまりにも
掛かり過ぎるようす。試しに100位に間引いて実施した所、非常に良い結果がでた。::

[2023-01-08 17:39:11.899338] Train Epoch: 1 [304/624 (49%)] Average loss: 0.022614

結果::

    accuracy                           0.88       268
       macro avg       0.03      0.03      0.03       268
       weighted avg       0.77      0.88      0.82       268

本当かいな？という感じはする。

データを5000くらいにして学習してみた結果が以下。かなりよい。全部のデータ1001個を
見た様子。ただし、percisionが0.00の所もあり、やはり、すべてのデータは一度見るような感じにする必要がある::

            precision    recall  f1-score   support
  
             0       1.00      1.00      1.00        16
             1       1.00      1.00      1.00        11
             2       1.00      1.00      1.00        10
             3       1.00      1.00      1.00        13
             4       1.00      1.00      1.00        10
             5       1.00      1.00      1.00        13
             6       1.00      1.00      1.00        10
             7       1.00      1.00      1.00        18
             8       1.00      1.00      1.00        10
             9       1.00      1.00      1.00        13
            10       1.00      1.00      1.00        20
            11       1.00      1.00      1.00        13
            12       1.00      1.00      1.00        11
            13       1.00      1.00      1.00        10
            14       1.00      1.00      1.00        15
            15       1.00      1.00      1.00        16
            16       1.00      1.00      1.00        15
            17       1.00      1.00      1.00        22
            18       1.00      1.00      1.00        13
            19       1.00      1.00      1.00        11
            20       1.00      1.00      1.00        17
            21       1.00      1.00      1.00        11
            22       1.00      1.00      1.00        19
            23       1.00      1.00      1.00        15
            24       0.42      1.00      0.60        14
            25       1.00      1.00      1.00        16
            26       1.00      1.00      1.00        20
            27       1.00      1.00      1.00        21
            28       1.00      1.00      1.00        17
            29       1.00      1.00      1.00        11
            30       1.00      1.00      1.00        22
            31       1.00      1.00      1.00        19
            32       1.00      1.00      1.00        11
            33       1.00      1.00      1.00        15
            34       1.00      1.00      1.00        14
            35       1.00      1.00      1.00        11
            36       1.00      1.00      1.00        19
            37       1.00      1.00      1.00        12
            38       1.00      1.00      1.00        21
            39       1.00      1.00      1.00        15
            40       1.00      1.00      1.00        12
            41       1.00      1.00      1.00         5
            42       1.00      1.00      1.00        12
            43       1.00      1.00      1.00        21
            44       1.00      1.00      1.00         9
            45       1.00      1.00      1.00        18
            46       1.00      1.00      1.00        10
            47       1.00      1.00      1.00        17
            48       1.00      1.00      1.00        11
            49       1.00      1.00      1.00        21
            50       1.00      1.00      1.00        20
            51       1.00      1.00      1.00        12
            52       1.00      1.00      1.00        18
            53       1.00      1.00      1.00        15
            54       1.00      1.00      1.00        13
            55       1.00      1.00      1.00        13
            56       1.00      1.00      1.00        15
            57       1.00      1.00      1.00        20
            58       1.00      1.00      1.00        14
            59       1.00      1.00      1.00        13
            60       1.00      1.00      1.00        16
            61       1.00      1.00      1.00        16
            62       1.00      1.00      1.00         9
            63       1.00      1.00      1.00        24
            64       1.00      1.00      1.00        12
            65       1.00      1.00      1.00         9
            66       1.00      1.00      1.00        25
            67       1.00      1.00      1.00        15
            68       1.00      1.00      1.00        18
            69       1.00      1.00      1.00        10
            70       1.00      1.00      1.00        18
            71       1.00      1.00      1.00        14
            72       1.00      1.00      1.00         8
            73       1.00      1.00      1.00        17
            74       1.00      1.00      1.00        12
            75       1.00      1.00      1.00        13
            76       1.00      1.00      1.00        14
            77       1.00      1.00      1.00        13
            78       1.00      1.00      1.00        12
            79       1.00      1.00      1.00        15
            80       1.00      1.00      1.00        14
            81       1.00      1.00      1.00        12
            82       1.00      1.00      1.00        12
            83       1.00      1.00      1.00        14
            84       1.00      1.00      1.00        24
            85       1.00      1.00      1.00        14
            86       1.00      1.00      1.00        16
            87       1.00      1.00      1.00        17
            88       1.00      1.00      1.00        15
            89       1.00      1.00      1.00        18
            90       1.00      1.00      1.00        22
            91       1.00      1.00      1.00        11
            92       1.00      1.00      1.00        13
            93       1.00      1.00      1.00        20
            94       1.00      1.00      1.00        15
            95       1.00      1.00      1.00        18
            96       1.00      1.00      1.00        11
            97       1.00      1.00      1.00        13
            98       1.00      1.00      1.00        16
            99       1.00      1.00      1.00        19
           100       1.00      1.00      1.00        21
           101       1.00      1.00      1.00        12
           102       1.00      1.00      1.00        17
           103       1.00      1.00      1.00        15
           104       0.69      1.00      0.82         9
           105       1.00      1.00      1.00        15
           106       0.80      0.94      0.86        17
           107       1.00      1.00      1.00        15
           108       1.00      1.00      1.00        19
           109       1.00      1.00      1.00        10
           110       1.00      1.00      1.00         7
           111       1.00      1.00      1.00        17
           112       1.00      1.00      1.00        21
           113       1.00      1.00      1.00        16
           114       1.00      1.00      1.00        15
           115       1.00      1.00      1.00        10
           116       1.00      1.00      1.00        20
           117       1.00      1.00      1.00        21
           118       1.00      1.00      1.00        12
           119       1.00      1.00      1.00        18
           120       1.00      1.00      1.00        12
           121       1.00      1.00      1.00         9
           122       1.00      1.00      1.00        18
           123       1.00      1.00      1.00        14
           124       1.00      1.00      1.00        11
           125       1.00      1.00      1.00        19
           126       1.00      1.00      1.00        14
           127       1.00      1.00      1.00        15
           128       1.00      1.00      1.00        18
           129       1.00      1.00      1.00        16
           130       1.00      1.00      1.00        15
           131       1.00      1.00      1.00        22
           132       1.00      1.00      1.00        17
           133       1.00      0.69      0.82        13
           134       1.00      1.00      1.00        14
           135       1.00      1.00      1.00        18
           136       1.00      1.00      1.00        13
           137       1.00      1.00      1.00        18
           138       1.00      1.00      1.00        19
           139       1.00      1.00      1.00        20
           140       1.00      1.00      1.00        11
           141       1.00      1.00      1.00        14
           142       1.00      1.00      1.00        14
           143       1.00      1.00      1.00        16
           144       1.00      1.00      1.00        12
           145       1.00      1.00      1.00        18
           146       1.00      1.00      1.00        15
           147       1.00      1.00      1.00        15
           148       1.00      1.00      1.00        13
           149       1.00      1.00      1.00        12
           150       1.00      1.00      1.00        20
           151       1.00      1.00      1.00        19
           152       1.00      1.00      1.00        18
           153       1.00      1.00      1.00        15
           154       1.00      1.00      1.00        21
           155       1.00      1.00      1.00        14
           156       1.00      1.00      1.00        11
           157       1.00      1.00      1.00        19
           158       1.00      1.00      1.00        15
           159       1.00      1.00      1.00        18
           160       1.00      1.00      1.00        10
           161       1.00      1.00      1.00        12
           162       1.00      1.00      1.00        15
           163       1.00      1.00      1.00        13
           164       1.00      1.00      1.00        14
           165       1.00      1.00      1.00        25
           166       1.00      1.00      1.00        14
           167       1.00      1.00      1.00        15
           168       1.00      1.00      1.00        18
           169       1.00      1.00      1.00        12
           170       1.00      1.00      1.00        17
           171       1.00      1.00      1.00        18
           172       1.00      1.00      1.00        15
           173       1.00      1.00      1.00         9
           174       1.00      1.00      1.00        18
           175       1.00      1.00      1.00        18
           176       1.00      1.00      1.00        18
           177       1.00      1.00      1.00        24
           178       1.00      1.00      1.00        14
           179       1.00      1.00      1.00        14
           180       1.00      1.00      1.00        10
           181       1.00      1.00      1.00        12
           182       1.00      1.00      1.00        11
           183       1.00      1.00      1.00        17
           184       1.00      1.00      1.00         9
           185       1.00      1.00      1.00        18
           186       1.00      1.00      1.00        10
           187       1.00      1.00      1.00        23
           188       1.00      1.00      1.00        13
           189       1.00      1.00      1.00        15
           190       1.00      1.00      1.00        12
           191       1.00      1.00      1.00        20
           192       1.00      1.00      1.00        14
           193       1.00      1.00      1.00        16
           194       1.00      1.00      1.00        18
           195       1.00      1.00      1.00        22
           196       1.00      1.00      1.00        13
           197       1.00      1.00      1.00        20
           198       1.00      1.00      1.00         7
           199       1.00      1.00      1.00        21
           200       1.00      1.00      1.00        11
           201       1.00      1.00      1.00        17
           202       1.00      1.00      1.00        15
           203       1.00      1.00      1.00        19
           204       1.00      1.00      1.00        17
           205       1.00      1.00      1.00        16
           206       1.00      1.00      1.00        18
           207       1.00      1.00      1.00        12
           208       1.00      1.00      1.00        14
           209       1.00      1.00      1.00        13
           210       1.00      1.00      1.00        20
           211       1.00      1.00      1.00        16
           212       1.00      1.00      1.00        19
           213       1.00      1.00      1.00        19
           214       1.00      1.00      1.00        14
           215       1.00      1.00      1.00        16
           216       1.00      1.00      1.00        17
           217       1.00      1.00      1.00        15
           218       1.00      1.00      1.00        21
           219       1.00      1.00      1.00        17
           220       1.00      1.00      1.00        24
           221       1.00      1.00      1.00        13
           222       1.00      1.00      1.00        21
           223       1.00      1.00      1.00        12
           224       1.00      1.00      1.00        13
           225       1.00      1.00      1.00        13
           226       1.00      1.00      1.00        16
           227       1.00      1.00      1.00        11
           228       1.00      1.00      1.00        15
           229       1.00      1.00      1.00        12
           230       1.00      1.00      1.00        10
           231       1.00      1.00      1.00        15
           232       1.00      1.00      1.00         5
           233       1.00      1.00      1.00         9
           234       1.00      1.00      1.00        10
           235       1.00      1.00      1.00        20
           236       1.00      1.00      1.00        11
           237       1.00      1.00      1.00        18
           238       1.00      1.00      1.00        14
           239       1.00      1.00      1.00        13
           240       1.00      1.00      1.00        19
           241       1.00      1.00      1.00         9
           242       1.00      1.00      1.00        12
           243       1.00      1.00      1.00        15
           244       1.00      1.00      1.00        16
           245       1.00      1.00      1.00        28
           246       1.00      1.00      1.00        14
           247       1.00      1.00      1.00        17
           248       1.00      1.00      1.00        17
           249       1.00      1.00      1.00        12
           250       1.00      1.00      1.00        17
           251       1.00      1.00      1.00        15
           252       1.00      1.00      1.00        19
           253       1.00      1.00      1.00        14
           254       1.00      1.00      1.00        17
           255       1.00      1.00      1.00        18
           256       1.00      1.00      1.00        18
           257       1.00      1.00      1.00        12
           258       1.00      1.00      1.00        12
           259       1.00      1.00      1.00        13
           260       1.00      1.00      1.00        10
           261       1.00      1.00      1.00        13
           262       1.00      1.00      1.00        10
           263       1.00      1.00      1.00        12
           264       1.00      1.00      1.00        15
           265       1.00      1.00      1.00        14
           266       1.00      1.00      1.00        15
           267       1.00      1.00      1.00        20
           268       1.00      1.00      1.00        12
           269       1.00      1.00      1.00        14
           270       1.00      1.00      1.00        17
           271       1.00      1.00      1.00        15
           272       1.00      1.00      1.00        13
           273       1.00      1.00      1.00         8
           274       1.00      1.00      1.00         9
           275       1.00      1.00      1.00        16
           276       1.00      1.00      1.00        20
           277       1.00      1.00      1.00        13
           278       1.00      1.00      1.00        17
           279       1.00      1.00      1.00        16
           280       1.00      1.00      1.00        13
           281       1.00      1.00      1.00        14
           282       1.00      1.00      1.00        20
           283       1.00      1.00      1.00        10
           284       1.00      1.00      1.00         7
           285       1.00      1.00      1.00        16
           286       1.00      1.00      1.00        12
           287       1.00      1.00      1.00        11
           288       1.00      1.00      1.00        17
           289       1.00      1.00      1.00        15
           290       1.00      1.00      1.00         9
           291       1.00      1.00      1.00        13
           292       1.00      1.00      1.00        12
           293       1.00      1.00      1.00        19
           294       1.00      1.00      1.00        17
           295       1.00      1.00      1.00        13
           296       1.00      1.00      1.00        16
           297       1.00      1.00      1.00        14
           298       1.00      1.00      1.00        10
           299       1.00      1.00      1.00        12
           300       1.00      1.00      1.00        12
           301       1.00      1.00      1.00        11
           302       1.00      1.00      1.00        16
           303       1.00      1.00      1.00        17
           304       1.00      1.00      1.00        11
           305       1.00      1.00      1.00        15
           306       1.00      1.00      1.00         9
           307       1.00      1.00      1.00        15
           308       1.00      1.00      1.00        15
           309       1.00      0.73      0.85        15
           310       1.00      1.00      1.00        15
           311       1.00      0.81      0.90        16
           312       1.00      1.00      1.00        10
           313       1.00      1.00      1.00        10
           314       1.00      1.00      1.00        14
           315       1.00      1.00      1.00        22
           316       1.00      1.00      1.00        15
           317       1.00      1.00      1.00        17
           318       1.00      1.00      1.00        19
           319       1.00      1.00      1.00        15
           320       1.00      1.00      1.00        14
           321       1.00      1.00      1.00        13
           322       1.00      1.00      1.00        14
           323       1.00      1.00      1.00        16
           324       1.00      1.00      1.00        21
           325       1.00      1.00      1.00        19
           326       1.00      1.00      1.00        17
           327       1.00      1.00      1.00        18
           328       1.00      1.00      1.00        14
           329       1.00      1.00      1.00        22
           330       1.00      1.00      1.00        18
           331       1.00      1.00      1.00        20
           332       1.00      1.00      1.00        10
           333       1.00      1.00      1.00        23
           334       1.00      1.00      1.00        19
           335       1.00      1.00      1.00        17
           336       1.00      1.00      1.00        19
           337       1.00      1.00      1.00        15
           338       1.00      1.00      1.00        15
           339       1.00      1.00      1.00        12
           340       1.00      1.00      1.00        13
           341       1.00      1.00      1.00        21
           342       1.00      1.00      1.00        17
           343       1.00      1.00      1.00         8
           344       1.00      1.00      1.00         9
           345       1.00      1.00      1.00        19
           346       1.00      1.00      1.00        11
           347       1.00      1.00      1.00        17
           348       1.00      1.00      1.00        14
           349       1.00      1.00      1.00        14
           350       1.00      1.00      1.00        20
           351       1.00      1.00      1.00        12
           352       1.00      1.00      1.00        13
           353       1.00      1.00      1.00        20
           354       1.00      1.00      1.00        13
           355       1.00      1.00      1.00        14
           356       1.00      1.00      1.00        15
           357       1.00      1.00      1.00        18
           358       1.00      1.00      1.00        14
           359       1.00      1.00      1.00        13
           360       1.00      1.00      1.00        13
           361       1.00      1.00      1.00        16
           362       1.00      1.00      1.00        25
           363       1.00      1.00      1.00        14
           364       1.00      1.00      1.00        11
           365       1.00      1.00      1.00        16
           366       1.00      1.00      1.00        18
           367       1.00      1.00      1.00        13
           368       1.00      1.00      1.00        12
           369       1.00      1.00      1.00        15
           370       1.00      1.00      1.00        12
           371       1.00      1.00      1.00        15
           372       1.00      1.00      1.00        14
           373       1.00      1.00      1.00        14
           374       1.00      1.00      1.00        12
           375       1.00      1.00      1.00        19
           376       1.00      1.00      1.00         8
           377       1.00      1.00      1.00        14
           378       1.00      1.00      1.00        21
           379       1.00      1.00      1.00        17
           380       1.00      1.00      1.00        20
           381       1.00      1.00      1.00        26
           382       1.00      1.00      1.00        19
           383       1.00      1.00      1.00        17
           384       1.00      1.00      1.00        14
           385       1.00      1.00      1.00        10
           386       1.00      1.00      1.00        13
           387       1.00      1.00      1.00        21
           388       1.00      1.00      1.00         8
           389       1.00      1.00      1.00        20
           390       1.00      1.00      1.00        10
           391       1.00      1.00      1.00        13
           392       1.00      1.00      1.00        20
           393       1.00      1.00      1.00        15
           394       1.00      1.00      1.00        21
           395       1.00      1.00      1.00        15
           396       1.00      1.00      1.00        17
           397       1.00      1.00      1.00        17
           398       1.00      1.00      1.00        12
           399       1.00      1.00      1.00        19
           400       1.00      1.00      1.00        18
           401       1.00      1.00      1.00        23
           402       1.00      1.00      1.00         9
           403       1.00      1.00      1.00        21
           404       1.00      1.00      1.00        13
           405       1.00      1.00      1.00        18
           406       1.00      1.00      1.00        10
           407       1.00      1.00      1.00        18
           408       1.00      1.00      1.00        15
           409       1.00      1.00      1.00        17
           410       1.00      1.00      1.00        20
           411       1.00      1.00      1.00        17
           412       1.00      1.00      1.00        20
           413       1.00      1.00      1.00        21
           414       1.00      1.00      1.00        16
           415       1.00      1.00      1.00        19
           416       1.00      1.00      1.00        17
           417       1.00      1.00      1.00        19
           418       1.00      1.00      1.00        17
           419       1.00      1.00      1.00        19
           420       1.00      1.00      1.00        12
           421       1.00      1.00      1.00        11
           422       1.00      1.00      1.00        15
           423       0.54      1.00      0.70        21
           424       1.00      1.00      1.00        18
           425       1.00      1.00      1.00        13
           426       1.00      1.00      1.00        15
           427       1.00      1.00      1.00        19
           428       1.00      1.00      1.00        14
           429       1.00      1.00      1.00         9
           430       1.00      1.00      1.00        11
           431       1.00      1.00      1.00        19
           432       1.00      1.00      1.00        11
           433       1.00      1.00      1.00        16
           434       1.00      1.00      1.00        17
           435       1.00      1.00      1.00        18
           436       1.00      1.00      1.00        20
           437       1.00      1.00      1.00         8
           438       1.00      1.00      1.00         9
           439       1.00      1.00      1.00        16
           440       1.00      1.00      1.00        21
           441       1.00      1.00      1.00        13
           442       1.00      1.00      1.00        13
           443       1.00      1.00      1.00        12
           444       1.00      1.00      1.00        10
           445       1.00      1.00      1.00         9
           446       1.00      1.00      1.00        17
           447       1.00      1.00      1.00        11
           448       1.00      1.00      1.00        13
           449       1.00      1.00      1.00        16
           450       1.00      1.00      1.00        27
           451       1.00      1.00      1.00        16
           452       1.00      1.00      1.00        12
           453       1.00      1.00      1.00        18
           454       1.00      1.00      1.00        15
           455       1.00      1.00      1.00        12
           456       1.00      1.00      1.00        17
           457       1.00      1.00      1.00        10
           458       1.00      1.00      1.00        15
           459       1.00      1.00      1.00        11
           460       1.00      1.00      1.00        10
           461       1.00      1.00      1.00        20
           462       1.00      1.00      1.00        14
           463       1.00      1.00      1.00        13
           464       1.00      1.00      1.00        14
           465       1.00      1.00      1.00        13
           466       1.00      1.00      1.00        13
           467       1.00      1.00      1.00        12
           468       0.60      1.00      0.75         9
           469       1.00      1.00      1.00        14
           470       1.00      1.00      1.00         9
           471       1.00      1.00      1.00        12
           472       1.00      1.00      1.00        12
           473       1.00      1.00      1.00        14
           474       1.00      1.00      1.00        14
           475       1.00      1.00      1.00        11
           476       1.00      1.00      1.00        16
           477       1.00      1.00      1.00         8
           478       1.00      1.00      1.00        11
           479       1.00      1.00      1.00        14
           480       1.00      1.00      1.00        12
           481       1.00      1.00      1.00        15
           482       1.00      1.00      1.00        17
           483       1.00      1.00      1.00        21
           484       1.00      1.00      1.00        20
           485       1.00      1.00      1.00        13
           486       0.00      0.00      0.00        19
           487       1.00      1.00      1.00        10
           488       1.00      1.00      1.00        13
           489       1.00      1.00      1.00        17
           490       1.00      1.00      1.00        19
           491       1.00      1.00      1.00        16
           492       1.00      1.00      1.00        15
           493       1.00      1.00      1.00        11
           494       1.00      1.00      1.00        14
           495       1.00      1.00      1.00        11
           496       1.00      1.00      1.00        13
           497       1.00      1.00      1.00        16
           498       1.00      1.00      1.00        14
           499       1.00      1.00      1.00        15
           500       1.00      1.00      1.00        16
           501       1.00      1.00      1.00        13
           502       1.00      1.00      1.00        16
           503       1.00      1.00      1.00        13
           504       1.00      1.00      1.00        22
           505       1.00      1.00      1.00        17
           506       1.00      1.00      1.00        20
           507       1.00      1.00      1.00        11
           508       1.00      1.00      1.00        20
           509       1.00      1.00      1.00        16
           510       1.00      1.00      1.00        16
           511       1.00      1.00      1.00        18
           512       1.00      1.00      1.00        13
           513       1.00      1.00      1.00        12
           514       1.00      1.00      1.00        19
           515       1.00      1.00      1.00        20
           516       1.00      1.00      1.00        12
           517       1.00      1.00      1.00        11
           518       1.00      1.00      1.00        21
           519       1.00      1.00      1.00        15
           520       1.00      1.00      1.00        19
           521       1.00      1.00      1.00        20
           522       1.00      1.00      1.00        19
           523       1.00      1.00      1.00         8
           524       1.00      1.00      1.00        13
           525       1.00      1.00      1.00        22
           526       1.00      1.00      1.00        16
           527       1.00      1.00      1.00        19
           528       1.00      1.00      1.00        18
           529       1.00      1.00      1.00        14
           530       1.00      1.00      1.00        17
           531       1.00      1.00      1.00        15
           532       1.00      1.00      1.00        20
           533       1.00      1.00      1.00        13
           534       1.00      1.00      1.00        14
           535       1.00      1.00      1.00        14
           536       1.00      1.00      1.00        20
           537       1.00      1.00      1.00        14
           538       1.00      1.00      1.00        12
           539       1.00      1.00      1.00        12
           540       1.00      1.00      1.00        18
           541       1.00      1.00      1.00        10
           542       1.00      1.00      1.00        18
           543       1.00      1.00      1.00         9
           544       1.00      1.00      1.00        15
           545       1.00      1.00      1.00        16
           546       1.00      1.00      1.00        12
           547       1.00      1.00      1.00        11
           548       1.00      1.00      1.00        14
           549       1.00      1.00      1.00         9
           550       1.00      1.00      1.00         8
           551       1.00      1.00      1.00        13
           552       1.00      1.00      1.00        14
           553       1.00      1.00      1.00         9
           554       1.00      1.00      1.00        17
           555       1.00      1.00      1.00        16
           556       1.00      1.00      1.00        17
           557       1.00      1.00      1.00         6
           558       1.00      1.00      1.00        11
           559       1.00      1.00      1.00        21
           560       1.00      1.00      1.00        13
           561       1.00      1.00      1.00        13
           562       1.00      1.00      1.00        24
           563       1.00      1.00      1.00        21
           564       1.00      1.00      1.00        14
           565       1.00      1.00      1.00        16
           566       1.00      1.00      1.00        10
           567       1.00      1.00      1.00        15
           568       1.00      1.00      1.00        13
           569       1.00      1.00      1.00        18
           570       1.00      1.00      1.00        12
           571       1.00      1.00      1.00        14
           572       1.00      1.00      1.00        13
           573       1.00      1.00      1.00        15
           574       1.00      1.00      1.00        13
           575       1.00      1.00      1.00        16
           576       1.00      1.00      1.00        12
           577       1.00      1.00      1.00        22
           578       1.00      1.00      1.00        15
           579       1.00      1.00      1.00         9
           580       1.00      1.00      1.00        13
           581       1.00      1.00      1.00        16
           582       1.00      1.00      1.00        19
           583       1.00      1.00      1.00        12
           584       1.00      1.00      1.00        15
           585       1.00      1.00      1.00        11
           586       1.00      1.00      1.00         9
           587       1.00      1.00      1.00        18
           588       1.00      1.00      1.00        18
           589       1.00      1.00      1.00         9
           590       1.00      1.00      1.00        19
           591       1.00      1.00      1.00        11
           592       1.00      1.00      1.00        21
           593       1.00      1.00      1.00        19
           594       1.00      1.00      1.00        16
           595       1.00      1.00      1.00        12
           596       1.00      1.00      1.00        18
           597       1.00      1.00      1.00         6
           598       1.00      1.00      1.00        16
           599       1.00      1.00      1.00        27
           600       1.00      1.00      1.00        15
           601       1.00      1.00      1.00        22
           602       1.00      1.00      1.00        12
           603       1.00      1.00      1.00        15
           604       1.00      1.00      1.00        10
           605       1.00      1.00      1.00         8
           606       1.00      1.00      1.00        16
           607       1.00      1.00      1.00        18
           608       1.00      1.00      1.00        15
           609       1.00      1.00      1.00        16
           610       1.00      1.00      1.00        13
           611       1.00      1.00      1.00        22
           612       1.00      1.00      1.00        15
           613       1.00      1.00      1.00        13
           614       1.00      1.00      1.00        17
           615       1.00      1.00      1.00        17
           616       1.00      1.00      1.00        21
           617       1.00      1.00      1.00         8
           618       1.00      1.00      1.00        20
           619       1.00      1.00      1.00        15
           620       1.00      1.00      1.00        12
           621       1.00      1.00      1.00        12
           622       1.00      1.00      1.00        18
           623       1.00      1.00      1.00        15
           624       1.00      1.00      1.00        19
           625       1.00      1.00      1.00        21
           626       1.00      1.00      1.00        14
           627       1.00      1.00      1.00        22
           628       1.00      1.00      1.00        19
           629       1.00      1.00      1.00        23
           630       1.00      1.00      1.00        13
           631       1.00      1.00      1.00        13
           632       1.00      1.00      1.00        16
           633       1.00      1.00      1.00         9
           634       1.00      1.00      1.00         9
           635       1.00      1.00      1.00        18
           636       1.00      1.00      1.00        16
           637       1.00      1.00      1.00        11
           638       1.00      1.00      1.00        12
           639       0.67      0.92      0.77        13
           640       1.00      1.00      1.00        20
           641       1.00      1.00      1.00        20
           642       1.00      1.00      1.00        12
           643       1.00      1.00      1.00        22
           644       1.00      1.00      1.00        15
           645       1.00      1.00      1.00        15
           646       1.00      1.00      1.00        17
           647       1.00      1.00      1.00        17
           648       1.00      1.00      1.00        25
           649       1.00      1.00      1.00        14
           650       1.00      1.00      1.00        14
           651       1.00      1.00      1.00        19
           652       1.00      1.00      1.00        13
           653       1.00      1.00      1.00        17
           654       1.00      1.00      1.00        12
           655       1.00      1.00      1.00        13
           656       1.00      1.00      1.00        10
           657       1.00      1.00      1.00        11
           658       1.00      1.00      1.00        20
           659       1.00      1.00      1.00        22
           660       1.00      0.92      0.96        13
           661       1.00      1.00      1.00         8
           662       1.00      1.00      1.00        14
           663       1.00      1.00      1.00        13
           664       1.00      1.00      1.00        17
           665       1.00      1.00      1.00        15
           666       1.00      1.00      1.00        13
           667       1.00      1.00      1.00        13
           668       1.00      1.00      1.00        14
           669       1.00      1.00      1.00        13
           670       1.00      1.00      1.00        20
           671       1.00      1.00      1.00        10
           672       1.00      1.00      1.00        17
           673       1.00      1.00      1.00        14
           674       1.00      1.00      1.00        12
           675       1.00      1.00      1.00        15
           676       1.00      1.00      1.00         9
           677       1.00      1.00      1.00         9
           678       1.00      1.00      1.00        11
           679       1.00      1.00      1.00         9
           680       1.00      1.00      1.00        15
           681       1.00      1.00      1.00        20
           682       1.00      1.00      1.00        13
           683       1.00      1.00      1.00        20
           684       1.00      1.00      1.00        13
           685       1.00      1.00      1.00        16
           686       1.00      1.00      1.00         8
           687       1.00      1.00      1.00         7
           688       1.00      1.00      1.00        17
           689       1.00      1.00      1.00        13
           690       1.00      1.00      1.00         7
           691       1.00      1.00      1.00        13
           692       1.00      1.00      1.00        21
           693       1.00      1.00      1.00        22
           694       1.00      1.00      1.00        21
           695       1.00      1.00      1.00         9
           696       1.00      1.00      1.00        16
           697       1.00      1.00      1.00        17
           698       1.00      1.00      1.00         8
           699       1.00      1.00      1.00        11
           700       1.00      1.00      1.00        13
           701       1.00      1.00      1.00         9
           702       1.00      1.00      1.00        16
           703       1.00      1.00      1.00        17
           704       1.00      1.00      1.00        14
           705       1.00      1.00      1.00        19
           706       1.00      1.00      1.00        15
           707       1.00      1.00      1.00         9
           708       1.00      1.00      1.00        13
           709       1.00      1.00      1.00        17
           710       1.00      1.00      1.00        11
           711       1.00      1.00      1.00        17
           712       1.00      1.00      1.00        20
           713       1.00      1.00      1.00        12
           714       1.00      1.00      1.00        19
           715       1.00      1.00      1.00        11
           716       1.00      1.00      1.00        13
           717       1.00      1.00      1.00        16
           718       1.00      1.00      1.00        21
           719       1.00      1.00      1.00        21
           720       0.79      1.00      0.88        11
           721       1.00      1.00      1.00        26
           722       1.00      1.00      1.00        19
           723       1.00      1.00      1.00        19
           724       1.00      1.00      1.00        18
           725       1.00      1.00      1.00        12
           726       1.00      1.00      1.00        13
           727       1.00      1.00      1.00        21
           728       1.00      1.00      1.00        13
           729       1.00      1.00      1.00        20
           730       1.00      1.00      1.00        12
           731       1.00      1.00      1.00        10
           732       1.00      1.00      1.00        13
           733       1.00      1.00      1.00        15
           734       1.00      1.00      1.00        17
           735       1.00      1.00      1.00        22
           736       1.00      1.00      1.00        13
           737       1.00      1.00      1.00        13
           738       1.00      1.00      1.00        18
           739       1.00      1.00      1.00        12
           740       1.00      1.00      1.00         7
           741       1.00      1.00      1.00        15
           742       1.00      1.00      1.00        19
           743       1.00      1.00      1.00        21
           744       1.00      1.00      1.00        19
           745       1.00      1.00      1.00        14
           746       1.00      1.00      1.00        15
           747       1.00      1.00      1.00        17
           748       1.00      1.00      1.00        14
           749       1.00      1.00      1.00         9
           750       1.00      1.00      1.00        12
           751       1.00      1.00      1.00        12
           752       1.00      1.00      1.00        17
           753       1.00      1.00      1.00        12
           754       1.00      1.00      1.00        21
           755       1.00      1.00      1.00        21
           756       1.00      1.00      1.00        15
           757       1.00      1.00      1.00        12
           758       1.00      1.00      1.00        18
           759       1.00      1.00      1.00        10
           760       1.00      1.00      1.00        26
           761       1.00      1.00      1.00        15
           762       1.00      1.00      1.00        15
           763       1.00      1.00      1.00        14
           764       1.00      1.00      1.00        14
           765       1.00      1.00      1.00        19
           766       1.00      1.00      1.00        14
           767       1.00      1.00      1.00        14
           768       1.00      1.00      1.00        15
           769       1.00      1.00      1.00        26
           770       1.00      1.00      1.00        12
           771       1.00      1.00      1.00        14
           772       1.00      1.00      1.00        12
           773       0.92      0.92      0.92        13
           774       1.00      1.00      1.00        12
           775       1.00      1.00      1.00        15
           776       1.00      1.00      1.00        13
           777       1.00      1.00      1.00        15
           778       1.00      1.00      1.00        19
           779       1.00      1.00      1.00        17
           780       1.00      1.00      1.00        10
           781       1.00      1.00      1.00        13
           782       1.00      1.00      1.00        12
           783       1.00      1.00      1.00        12
           784       1.00      1.00      1.00        20
           785       1.00      1.00      1.00        11
           786       1.00      1.00      1.00        14
           787       1.00      1.00      1.00        16
           788       1.00      1.00      1.00        14
           789       1.00      1.00      1.00        16
           790       1.00      1.00      1.00        15
           791       1.00      1.00      1.00        11
           792       1.00      1.00      1.00        17
           793       1.00      1.00      1.00        12
           794       1.00      1.00      1.00        15
           795       1.00      1.00      1.00        16
           796       1.00      1.00      1.00        18
           797       1.00      1.00      1.00        15
           798       1.00      1.00      1.00        11
           799       1.00      1.00      1.00        16
           800       1.00      1.00      1.00        12
           801       1.00      1.00      1.00        17
           802       1.00      1.00      1.00        19
           803       0.93      1.00      0.96        13
           804       1.00      1.00      1.00        10
           805       1.00      1.00      1.00        13
           806       1.00      1.00      1.00        11
           807       1.00      1.00      1.00        10
           808       1.00      1.00      1.00        15
           809       1.00      1.00      1.00        13
           810       0.00      0.00      0.00        18
           811       1.00      1.00      1.00        16
           812       1.00      1.00      1.00        13
           813       1.00      0.58      0.74        12
           814       1.00      1.00      1.00        17
           815       1.00      1.00      1.00        21
           816       1.00      1.00      1.00        15
           817       1.00      1.00      1.00        10
           818       1.00      1.00      1.00        10
           819       1.00      1.00      1.00        14
           820       1.00      1.00      1.00        17
           821       1.00      1.00      1.00        16
           822       1.00      1.00      1.00        21
           823       1.00      1.00      1.00        12
           824       1.00      1.00      1.00        12
           825       1.00      1.00      1.00        15
           826       1.00      1.00      1.00        11
           827       1.00      1.00      1.00        16
           828       1.00      1.00      1.00        18
           829       1.00      1.00      1.00        16
           830       1.00      1.00      1.00        16
           831       1.00      1.00      1.00        14
           832       1.00      1.00      1.00        16
           833       1.00      1.00      1.00        16
           834       1.00      1.00      1.00         9
           835       1.00      1.00      1.00        21
           836       0.67      1.00      0.80         8
           837       1.00      1.00      1.00        14
           838       1.00      1.00      1.00        11
           839       1.00      1.00      1.00        11
           840       1.00      1.00      1.00         9
           841       1.00      1.00      1.00        16
           842       1.00      1.00      1.00         8
           843       1.00      1.00      1.00        14
           844       1.00      1.00      1.00        19
           845       1.00      1.00      1.00         9
           846       1.00      1.00      1.00        16
           847       1.00      1.00      1.00        12
           848       1.00      1.00      1.00        21
           849       1.00      1.00      1.00        16
           850       1.00      1.00      1.00        19
           851       1.00      1.00      1.00        15
           852       1.00      1.00      1.00        12
           853       1.00      1.00      1.00        16
           854       1.00      1.00      1.00        18
           855       1.00      1.00      1.00        16
           856       1.00      1.00      1.00        22
           857       1.00      1.00      1.00        11
           858       1.00      1.00      1.00        17
           859       1.00      1.00      1.00        22
           860       1.00      1.00      1.00        15
           861       1.00      1.00      1.00        24
           862       1.00      1.00      1.00        15
           863       1.00      1.00      1.00        19
           864       1.00      1.00      1.00        14
           865       1.00      1.00      1.00        13
           866       1.00      1.00      1.00        17
           867       1.00      1.00      1.00         9
           868       1.00      1.00      1.00        18
           869       1.00      1.00      1.00        14
           870       1.00      1.00      1.00        18
           871       1.00      1.00      1.00        18
           872       1.00      1.00      1.00        14
           873       1.00      1.00      1.00        11
           874       1.00      1.00      1.00        12
           875       1.00      1.00      1.00        27
           876       1.00      1.00      1.00        11
           877       1.00      1.00      1.00        15
           878       1.00      1.00      1.00        15
           879       1.00      1.00      1.00        18
           880       1.00      1.00      1.00        16
           881       1.00      1.00      1.00        25
           882       1.00      1.00      1.00        12
           883       1.00      1.00      1.00        15
           884       1.00      1.00      1.00        16
           885       1.00      1.00      1.00         8
           886       1.00      1.00      1.00        13
           887       1.00      1.00      1.00        19
           888       1.00      1.00      1.00        20
           889       1.00      1.00      1.00        18
           890       1.00      1.00      1.00        14
           891       1.00      1.00      1.00        17
           892       1.00      1.00      1.00        14
           893       1.00      1.00      1.00        19
           894       1.00      1.00      1.00         4
           895       1.00      1.00      1.00        10
           896       1.00      1.00      1.00        16
           897       1.00      1.00      1.00        14
           898       1.00      1.00      1.00        12
           899       1.00      1.00      1.00        11
           900       1.00      1.00      1.00        12
           901       1.00      1.00      1.00        13
           902       1.00      1.00      1.00        14
           903       1.00      1.00      1.00        15
           904       1.00      1.00      1.00        11
           905       1.00      1.00      1.00        14
           906       1.00      1.00      1.00        21
           907       1.00      1.00      1.00        17
           908       1.00      1.00      1.00        19
           909       0.94      0.79      0.86        19
           910       1.00      1.00      1.00        17
           911       1.00      1.00      1.00        15
           912       1.00      1.00      1.00        16
           913       1.00      1.00      1.00        20
           914       1.00      1.00      1.00        16
           915       1.00      1.00      1.00         5
           916       1.00      1.00      1.00         9
           917       1.00      1.00      1.00         8
           918       1.00      1.00      1.00        12
           919       1.00      1.00      1.00        15
           920       1.00      1.00      1.00         9
           921       1.00      1.00      1.00        16
           922       1.00      1.00      1.00         9
           923       1.00      1.00      1.00        20
           924       1.00      1.00      1.00        13
           925       1.00      1.00      1.00        21
           926       1.00      1.00      1.00        11
           927       1.00      1.00      1.00        19
           928       1.00      1.00      1.00        11
           929       1.00      1.00      1.00         7
           930       1.00      1.00      1.00         6
           931       1.00      1.00      1.00        15
           932       1.00      1.00      1.00        17
           933       1.00      1.00      1.00        13
           934       1.00      1.00      1.00        18
           935       1.00      1.00      1.00        18
           936       1.00      1.00      1.00         9
           937       1.00      1.00      1.00        13
           938       1.00      1.00      1.00        23
           939       1.00      1.00      1.00        18
           940       1.00      1.00      1.00        18
           941       1.00      1.00      1.00        17
           942       1.00      1.00      1.00         9
           943       1.00      1.00      1.00        13
           944       1.00      1.00      1.00        15
           945       1.00      1.00      1.00        16
           946       1.00      1.00      1.00        15
           947       1.00      1.00      1.00        16
           948       1.00      1.00      1.00        19
           949       1.00      1.00      1.00        10
           950       1.00      1.00      1.00        15
           951       1.00      1.00      1.00        14
           952       1.00      1.00      1.00        14
           953       1.00      0.50      0.67        12
           954       1.00      1.00      1.00        19
           955       1.00      1.00      1.00        11
           956       1.00      0.92      0.96        13
           957       1.00      1.00      1.00         9
           958       1.00      1.00      1.00         6
           959       1.00      1.00      1.00        11
           960       1.00      1.00      1.00        22
           961       1.00      1.00      1.00        14
           962       1.00      1.00      1.00        16
           963       1.00      1.00      1.00        18
           964       1.00      1.00      1.00        16
           965       1.00      1.00      1.00        14
           966       1.00      1.00      1.00        19
           967       1.00      1.00      1.00        15
           968       1.00      1.00      1.00        20
           969       1.00      1.00      1.00        12
           970       1.00      1.00      1.00        14
           971       1.00      1.00      1.00        10
           972       1.00      1.00      1.00        11
           973       1.00      1.00      1.00        18
           974       1.00      1.00      1.00        21
           975       1.00      1.00      1.00        14
           976       1.00      1.00      1.00        20
           977       1.00      1.00      1.00        20
           978       1.00      1.00      1.00        10
           979       1.00      1.00      1.00        19
           980       1.00      1.00      1.00        14
           981       1.00      1.00      1.00        20
           982       1.00      1.00      1.00        12
           983       1.00      1.00      1.00        17
           984       1.00      1.00      1.00        15
           985       1.00      1.00      1.00        23
           986       1.00      1.00      1.00        15
           987       1.00      1.00      1.00        11
           988       1.00      1.00      1.00        13
           989       1.00      1.00      1.00        15
           990       0.95      1.00      0.97        18
           991       1.00      1.00      1.00        18
           992       1.00      1.00      1.00        13
           993       1.00      1.00      1.00        15
           994       1.00      1.00      1.00        19
           995       1.00      1.00      1.00        12
           996       1.00      1.00      1.00        13
           997       1.00      1.00      1.00        11
           998       1.00      1.00      1.00        13
           999       1.00      1.00      1.00        12
          1000       1.00      1.00      1.00       251
  
      accuracy                           1.00     15238
     macro avg       0.99      1.00      0.99     15238
  Weighted avg       0.99      1.00      0.99     15238
  
  A@pytorch:~/resset$ 
  

しかし、以下の問題がある。

1. ResNet34で無理やりoutputを35 -> 1001にしているが本当に大丈夫か。

2. 間引いて実施しているので1001文字の認識ではない。

1.はしらん。今後いろいろと試してみるなかで上手く行くかを考えてみる。2はdata_setのdata augumentationとかの
バリエーションを減らすことで対応が可能。

SSDをやるpytorchの方と、ResNetのこっちのほうで使うデータ種別が同じだけど、
使うデータサイズが異なるということになってしまうので管理がすげー面倒。

けど、とりあえず、ResNetでどうか？というのを試してみたい。

まず、学習結果得られた重みを用いて、SSDで上手く行かなかったバッテンがどうなのかを試してみたい。



https://github.com/miyakz1192/ml_study.git
記録"c7a2442e864ad698e4f460a87c386a95612c12a2"から引用。

引用：トライ３(SSDでの結果)
================================

SSDでは、漢字や日本語は誤検出が多いがそれなりに検出出来るようにはなった。しかし、以下のような困った事態が発生した
その際使った重みは以下。::
  a@pytorch:~/pytorch_ssd$ sha256sum close_weight_0.6436714378563133.pth
  15ba29eab2f8162bb5663d07acb812986c06b063a2bc542974e6db43a93cb94e  close_weight_0.6436714378563133.pth
  a@pytorch:~/pytorch_ssd$ 



1. 本物ののcloseなのにja_charと誤認識してしまう
   hit enter file==> imgdata/lu_Screenshot_2022-11-11-00-34-25-48_56bd83b73c18fa95b476c6c0f96c6836.jpg
   ただ、こちらは、白地に黒色のバッテン。いままで、黒字に白色のバッテンを学習していたので、コントラストが逆。
   このタイプのバッテンは一度もinputしていない。なので、ja_charと判定されたか。


2. 本物のcloseだけどcloseと認識しない。

   hit enter file==> imgdata/ru_Screenshot_2022-10-21-00-19-35-30_56bd83b73c18fa95b476c6c0f96c6836.jpg
   ちょっと太字な黒地に白のバッテン、バッテンの足が少し短い感じの


あと、薄いグレー地に白色のバッテンは相変わらず認識してくれない。
hit enter file==> imgdata/ru_Screenshot_2022-11-11-00-41-06-93_56bd83b73c18fa95b476c6c0f96c6836.jpg
hit enter file==> imgdata/ru_Screenshot_2022-12-05-20-05-24-88_56bd83b73c18fa95b476c6c0f96c6836.jpg
hit enter file==> imgdata/ru_Screenshot_2022-12-07-15-40-28-75_56bd83b73c18fa95b476c6c0f96c6836.jpg
このバッテンは人間でもわかりにくい感じがするが、見分けがつく。
これより薄いグレーにしたら、インアクティブなバッテンとの区別がつかなくなりそうでかなり微妙な路線。

hit enter file==> imgdata/ru_Screenshot_2022-12-07-16-09-56-86_56bd83b73c18fa95b476c6c0f96c6836.jpg
これは漢字を背景に、薄いグレーの上に白地のバッテンが重なったもの。
closeは認識しないが、ja_charは認識した例。


hit enter file==> imgdata/ru_Screenshot_2022-12-08-18-27-03-36_56bd83b73c18fa95b476c6c0f96c6836.jpg
closeもja_charも特に認識しない。


hit enter file==> imgdata/ru_Screenshot_2022-12-08-23-17-20-54_56bd83b73c18fa95b476c6c0f96c6836.jpg
本物のcloseはあるのだけど、やっぱり薄いグレー地に白色のバッテンは弱い。
代わりに変な所をcloseと認識(0.62)



hit enter file==> imgdata/ru_Screenshot_2022-12-09-00-20-49-28_56bd83b73c18fa95b476c6c0f96c6836.jpg
ただ、どういうことか、こちらの画像では薄いグレー地に白のバッテンは0.83で認識
hit enter file==> imgdata/lu_Screenshot_2022-10-21-00-23-35-12_56bd83b73c18fa95b476c6c0f96c6836.jpg
同上(0.84)


あとは、画像残っていたけど、力尽きた。時間あれば追加確認。

以下、最初のトライでＮＧが出た画像で今回のトライで認識されていいるNG(例：薄グレー地に白バッテンなど)を除いたものを確認。
結果、誤検出はなくなり、今回の重みはかなり進歩していることが確認できた。

hit enter file==> data/lu_Screenshot_2022-11-11-00-41-06-93_56bd83b73c18fa95b476c6c0f96c6836.jpg
最初のトライ：「本当のcloseがそもそも含まれない画像。しかし、漢字をcloseとご検出してしまっている。
漢字が多いと確かに、closeのバッテン(クロス)が含まれるので、ここを誤検出している。
漢字は厄介だ。。。」
　→　漢字をcloseと誤認識することはなくなった。ja_charを数文字検出


hit enter file==> data/ru_Screenshot_2022-11-11-00-37-18-58_56bd83b73c18fa95b476c6c0f96c6836.jpg
最初のトライ：本当のcloseがそもそも含まれない画像。宣伝のゲームの中にcloseと誤検出されるものが混じってしまっている。
　→　closeの誤認識はなくなった。

hit enter file==> data/lu_Screenshot_2022-12-05-20-23-33-26_56bd83b73c18fa95b476c6c0f96c6836.jpg
最初のトライ：ゲーム画像を誤検出。見た感じバッテンの要素は全然なさそうだが、、、
　→　誤検出はなくなった。

hit enter file==> data/lu_Screenshot_2022-12-07-16-09-56-86_56bd83b73c18fa95b476c6c0f96c6836.jpg
最初のトライ：漢字を誤検出
　→　誤検出はなくなった。ja_charを数文字検出

hit enter file==> data/lu_Screenshot_2022-12-08-18-32-13-36_56bd83b73c18fa95b476c6c0f96c6836.jpg
最初のトライ： 誤検出。ただし、0.6と低い数値だが。
　→　closeの誤検出はなくなった。ja_charを２文字検出。ただし、いずれも誤検出。closeの誤検出はなくなったので良しとする。

hit enter file==> data/lu_Screenshot_2022-12-08-18-33-56-71_56bd83b73c18fa95b476c6c0f96c6836.jpg
 最初のトライ：   漢字を誤検出。白色のバッテンを検出しないのはエライのだが、「残」を0.95とかなり高い確率で誤検出。
　→　closeの誤検出はなくなった。ja_charを正しく検出。

hit enter file==> data/lu_Screenshot_2022-12-08-23-17-20-54_56bd83b73c18fa95b476c6c0f96c6836.jpg
 最初のトライ： 漢字「者」を0.84で高い誤検出
 →　誤検出はなくなった

hit enter file==> data/lu_Screenshot_2022-12-09-00-20-49-28_56bd83b73c18fa95b476c6c0f96c6836.jpg
 最初のトライ： ゲーム中の顔？を0.95位で高い誤検出
　→　誤検出はなくなった。

hit enter file==> data/ru_Screenshot_2022-12-08-18-33-56-71_56bd83b73c18fa95b476c6c0f96c6836.jpg
  最初のトライ： 充電の電池記号を0.86で誤検出。なんで。。。
　→　誤検出はなくなった。

hit enter file==> data/ru_Screenshot_2022-12-10-10-17-54-32_56bd83b73c18fa95b476c6c0f96c6836.jpg
  最初のトライ： closeは無いのだが、他の麻雀牌とか背景っぽいものをご認識してしまっている0.7位
　→　誤検出はなくなった。


トライ3の考察
===================

SSDでは誤認識が発生したものをResNet34だとどのように認識するか。
なお、各画像からバッテンを32 x 32位の大きさで切り抜き、ResNet34に通すときはモデルの規定どおり224 x 224にリサイズして
predictすることにする。

軒並み悪い結果となった!
1、２つめはＯＫだけども、その他はＮＧ(1000となっていれば、closew)::

  a@pytorch:~/resset$ python3 core/resnet34.py single test_data/forResNet/1.jpg 
  INFO main
  /home/a/.local/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
    warnings.warn(
  /home/a/.local/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet34_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet34_Weights.DEFAULT` to get the most up-to-date weights.
    warnings.warn(msg)
  (1000, 11)

→　imgdata/lu_Screenshot_2022-11-11-00-34-25-48_56bd83b73c18fa95b476c6c0f96c6836.jpgのバッテン画像。こちらOK

次::

  a@pytorch:~/resset$ python3 core/resnet34.py single test_data/forResNet/2.jpg 
  INFO main
  /home/a/.local/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
    warnings.warn(
  /home/a/.local/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet34_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet34_Weights.DEFAULT` to get the most up-to-date weights.
    warnings.warn(msg)
  (1000, 6)

→  imgdata/ru_Screenshot_2022-10-21-00-19-35-30_56bd83b73c18fa95b476c6c0f96c6836.jpgの画像。こちらOK
   
次::

  a@pytorch:~/resset$ python3 core/resnet34.py single test_data/forResNet/3.jpg 
  INFO main
  /home/a/.local/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
    warnings.warn(
  /home/a/.local/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet34_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet34_Weights.DEFAULT` to get the most up-to-date weights.
    warnings.warn(msg)
  (280, 7)

→  imgdata/ru_Screenshot_2022-11-11-00-41-06-93_56bd83b73c18fa95b476c6c0f96c6836.jpg。薄グレーじのしろ色バッテンはミス。このパターンはResNet34にcloseとはインプットしていない。しょうがないと思われる

::


  a@pytorch:~/resset$ python3 core/resnet34.py single test_data/forResNet/4.jpg 
  INFO main
  /home/a/.local/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
    warnings.warn(
  /home/a/.local/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet34_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet34_Weights.DEFAULT` to get the most up-to-date weights.
    warnings.warn(msg)
  (1000, 9)

→　　hit enter file==> imgdata/ru_Screenshot_2022-12-05-20-05-24-88_56bd83b73c18fa95b476c6c0f96c6836.jpgこちらはＯＫ。✕の後ろに複雑な背景写っているけど、ｎａｚｅｋａＯＫ

::

  a@pytorch:~/resset$ python3 core/resnet34.py single test_data/forResNet/5.jpg 
  INFO main
  /home/a/.local/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
    warnings.warn(
  /home/a/.local/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet34_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet34_Weights.DEFAULT` to get the most up-to-date weights.
    warnings.warn(msg)
  (797, 6)

hit enter file==> imgdata/ru_Screenshot_2022-12-07-15-40-28-75_56bd83b73c18fa95b476c6c0f96c6836.jpgの画像。薄グレーパターンはやっぱりインプットしていないので弱いか。

以降、薄グレーパターンと、さらに＋αで漢字が背景。

::

  a@pytorch:~/resset$ python3 core/resnet34.py single test_data/forResNet/6.jpg 
  INFO main
  /home/a/.local/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
    warnings.warn(
  /home/a/.local/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet34_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet34_Weights.DEFAULT` to get the most up-to-date weights.
    warnings.warn(msg)
  (670, 6)
  a@pytorch:~/resset$ python3 core/resnet34.py single test_data/forResNet/7.jpg 
  INFO main
  /home/a/.local/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
    warnings.warn(
  /home/a/.local/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet34_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet34_Weights.DEFAULT` to get the most up-to-date weights.
    warnings.warn(msg)
  (934, 9)
  a@pytorch:~/resset$ python3 core/resnet34.py single test_data/forResNet/8.jpg 
  INFO main
  /home/a/.local/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
    warnings.warn(
  /home/a/.local/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet34_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet34_Weights.DEFAULT` to get the most up-to-date weights.
    warnings.warn(msg)
  (591, 9)
  a@pytorch:~/resset$ python3 core/resnet34.py single test_data/forResNet/9.jpg 
  INFO main
  /home/a/.local/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
    warnings.warn(
  /home/a/.local/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet34_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet34_Weights.DEFAULT` to get the most up-to-date weights.
    warnings.warn(msg)
  (64, 6)
  a@pytorch:~/resset$ 

考察
=====

そういえば、closeがグレー背景に白地バッテンだったので、こちらを加えて、もう一回ResNet34で学習してみる。

トライ4の結果
===================

グレー背景に白地バッテンを追加して学習させたところ、上記のまずかった画像のほとんどが問題なく
closeと認識できるようになった大変素晴らしい結果である。

また、

グレー背景に漢字が混ざって背景にある白地バッテン(test_data/forResNet/7.jpg)に対して、
ガウシアンブラーを掛けて、さらにエッジディテクトした後認識するとcloseと認識するようになった(10.jpg)。

このため、closeの認識には、一度こういった画像の下準備があると更に認識率が高まることがわかった。

トライ5
=========

ResNet34は随分上手く行きそうなので、ここでSSDに戻る。SSDでclose(っぽい)位置をちゃんと検出すれば、
後はResNet34で精度の高い認識ができるため、やはり、SSDでちゃんと薄グレー地に白バッテン(White Close On Light Glay:WCOLG)がSSDで認識できるかが重要な点になる。 
  
ここで、一旦、ResNet34で学習したDataSetをSSDでも再学習する必要があるが、image managementに若干なる変更と工夫が必要である。

・SSDの時でもja_charを学習するときに./bin/ja_char_gen/配下に資材などを作ったので、それをmasterにmerge
・ResNet34への学習のため、トレーニング画像を64 x 64にしている(各projectのdaug.py)。SSDになると、400 x 400がインプットになるため、400 x 400の(0,0)を原点としてそこに学習対象の実際の画像を貼り付けてやる必要がある。これはdaug.pyで使われているクラスDataAugmentationGeneratorで行われている処理だった。ResNet34の場合、各projectのdaug.pyでは、DataAugmentationGeneratorのコンストラクタにbase_image_size=(64,64)を指定しているが、SSDでは400,400になる。つまり、学習フレームワークによって画像サイズが変わるため、全体で一括で変更できるようにすると便利だ。この対応を行う必要がある。
・細かい話はdl_image_managerで管理する。

  

